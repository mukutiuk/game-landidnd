function r(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=Array(t);e<t;e++)n[e]=r[e];return n}function t(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,void 0)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var e=document.querySelector(".game-field"),n=document.querySelector(".game-score"),o=document.querySelector(".start"),i=document.querySelector(".message-start"),a=document.querySelector(".message-win"),c=document.querySelector(".message-lose"),u=0,s=[],f=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];function l(){for(var r="<tbody>",t=0;t<f.length;t++){r+='<tr class="field-row">';for(var o=0;o<f[t].length;o++)r+='<td class="field-cell\n      field-cell--'.concat(f[t][o],'">').concat(f[t][o]||"","</td>");r+="</tr>"}r+="</tbody>",e.innerHTML=r,n.innerText=u}function y(){for(var r=0;r<f.length;r++)for(var t=0;t<f[r].length;t++)s.push({x:r,y:t,isEmpty:!0})}function d(){var r=function(){var r=s.filter(function(r){return r.isEmpty});if(r.length){var t=Math.floor(Math.random()*r.length);return r[t]}}(),t=r.x,e=r.y;s=s.map(function(r){if(r.x===t&&r.y===e){var n,o;return n=function(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},n=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.forEach(function(t){var n;n=e[t],t in r?Object.defineProperty(r,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[t]=n})}return r}({},r),o=o={isEmpty:!1},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):(function(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e.push.apply(e,n)}return e})(Object(o)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(o,r))}),n}return r}),f[t][e]=Math.random()>.9?4:2;var n=f.map(function(r){return Math.max.apply(Math,r)});Math.max.apply(null,n)>=2048&&a.classList.remove("hidden")}function m(){window.addEventListener("keydown",p,{once:!0})}function p(r){switch(r.key){case"ArrowUp":if(!x(v()))return m();h(v());break;case"ArrowDown":if(!O())return m();h(v().map(function(r){return t(r).reverse()}));break;case"ArrowRight":if(!w())return m();h(b().map(function(r){return t(r).reverse()}));break;case"ArrowLeft":if(!x(b()))return m();h(b())}d(),x(v())||O()||x(b())||w()||c.classList.remove("hidden"),l()}function v(){return s.reduce(function(r,t){return r[t.y]=r[t.y]||[],r[t.y][t.x]=t,r},[])}function b(){return s.reduce(function(r,t){return r[t.x]=r[t.x]||[],r[t.x][t.y]=t,r},[])}function h(r){r.forEach(function(r){return function(r){for(var t=0;t<r.length;t++)if(!0!==r[t].isEmpty){for(var e=r[t],n=void 0,o=t-1;o>=0&&(!0===r[o].isEmpty||g(r[o],e));)g(r[o],e)&&(u+=2*f[e.x][e.y]),n=r[o],o--;var i=f[e.x][e.y];n&&(f[e.x][e.y]=0,function(r,t){var e=!0,n=!1,o=void 0;try{for(var i,a=s[Symbol.iterator]();!(e=(i=a.next()).done);e=!0){var c=i.value;c.x===t.x&&c.y===t.y&&(c.isEmpty=!1),c.x===r.x&&c.y===r.y&&(c.isEmpty=!0)}}catch(r){n=!0,o=r}finally{try{e||null==a.return||a.return()}finally{if(n)throw o}}}(e,n),f[n.x][n.y]+=i,l())}}(r)})}function g(r,t){return f[r.x][r.y]===f[t.x][t.y]}function O(){return x(v().map(function(r){return t(r).reverse()}))}function w(){return x(b().map(function(r){return t(r).reverse()}))}function x(r){return r.some(function(r){return r.some(function(t,e){if(0===e||!0===t.isEmpty)return!1;var n=r[e-1];return l(),!0===n.isEmpty||g(t,n)})})}o.addEventListener("click",function(r){i.classList.add("hidden"),c.classList.add("hidden"),o.classList.contains("start")&&(o.classList.replace("start","restart"),o.innerText="Restart",a.classList.add("hidden")),u=0,s=[],y(),f=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],d(),d(),document.addEventListener("keydown",p),l()}),y();
//# sourceMappingURL=index.ba7adca1.js.map
